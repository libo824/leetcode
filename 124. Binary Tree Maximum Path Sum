class Solution {
public:
    int maxPathSum(TreeNode* root) {
        int res = root->val;
        maxPathDFS(root, res);
        return res;
    }
private:
    int maxPathDFS(TreeNode* root, int &res){
        if(!root) return 0;
        int left = maxPathDFS(root->left,res);
        int right = maxPathDFS(root->right,res);
        int top = root->val + (left>0?left:0)+ (right>0?right:0);
        res = max(res,top);
        return max(left,right)>0?max(left,right)+root->val:root->val;
    }
};
